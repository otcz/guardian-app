<div class="p-3">
  <div class="flex justify-content-between align-items-center mb-3">
    <h2 class="m-0">Organizaciones</h2>
    <div class="flex gap-2">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input pInputText type="text" placeholder="Filtrar" [(ngModel)]="filter" (ngModelChange)="applyFilter()" style="width:16rem" />
      </span>
      <button pButton type="button" label="Crear" icon="pi pi-plus" (click)="goCreate()" class="p-button-success"></button>
      <button pButton type="button" label="Recargar" icon="pi pi-refresh" (click)="load()" [disabled]="loading"></button>
    </div>
  </div>

  <p *ngIf="error" class="p-error mb-3">{{error}}</p>
  <p *ngIf="!loading && !error && filtered.length===0" class="mb-3">No hay organizaciones.</p>

  <p-table *ngIf="filtered.length>0" [value]="filtered" [loading]="loading" [tableStyle]="{ 'min-width': '60rem' }" responsiveLayout="scroll">
    <ng-template pTemplate="header">
      <tr>
        <th style="width:3rem">#</th>
        <th>Nombre</th>
        <th>Activa</th>
        <th>Creación</th>
        <th style="width:15rem">Acciones</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-row let-i="rowIndex">
      <tr>
        <td>{{i+1}}</td>
        <td>{{row.nombre}}</td>
        <td>
          <p-tag [severity]="row.activa ? 'success' : 'danger'" [value]="row.activa ? 'SÍ' : 'NO'"></p-tag>
        </td>
        <td>{{row.fecha_creacion | date:'short'}}</td>
        <td class="flex gap-2">
          <button pButton type="button" icon="pi pi-pencil" class="p-button-rounded p-button-text" (click)="manage(row)" pTooltip="Gestionar"></button>
          <button pButton type="button" icon="pi pi-cog" class="p-button-rounded p-button-text" (click)="strategy(row)" pTooltip="Estrategia"></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

