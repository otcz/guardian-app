<div class="list-wrapper">
  <!-- Toolbar principal -->
  <div class="list-header org-toolbar">
    <h2>Organizaciones</h2>
    <span class="spacer"></span>
    <div class="list-actions flex ai-center gap-sm flex-wrap">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input pInputText type="text" placeholder="Filtrar" [(ngModel)]="filter" (ngModelChange)="applyFilter()" class="w-200" />
      </span>
      <app-theme-toggle mode="cycle"></app-theme-toggle>
      <button pButton type="button" label="Crear" icon="pi pi-plus" (click)="goCreate()" class="p-button-success"></button>
      <button pButton type="button" label="Recargar" icon="pi pi-refresh" (click)="load()" [disabled]="loading"></button>
    </div>
  </div>

  <p *ngIf="error" class="p-error mb-sm fs-sm">{{error}}</p>
  <p *ngIf="!loading && !error && filtered.length===0" class="mb-sm fs-sm text-muted">No hay organizaciones.</p>

  <div *ngIf="filtered.length>0" class="table-shell">
    <div class="table-meta fs-xs text-muted mb-xs">Mostrando {{filtered.length}} de {{orgs.length}}</div>
    <p-table [value]="filtered" [loading]="loading" styleClass="p-datatable-sm org-table table-hover" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th class="w-70">#</th>
          <th>Nombre</th>
            <th class="w-110">Activa</th>
          <th class="w-160">Creación</th>
          <th class="w-160 text-center">Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-row let-i="rowIndex">
        <tr>
          <td>{{i+1}}</td>
          <td>{{row.nombre}}</td>
          <td>
            <p-tag [severity]="row.activa ? 'success' : 'danger'" [value]="row.activa ? 'SÍ' : 'NO'"></p-tag>
          </td>
          <td><span class="fs-xs opacity-80">{{row.fecha_creacion | date:'yyyy-MM-dd HH:mm'}}</span></td>
          <td class="flex gap-xs ai-center justify-center">
            <button pButton type="button" icon="pi pi-pencil" class="p-button-rounded p-button-text" (click)="manage(row)" pTooltip="Gestionar" tooltipPosition="top"></button>
            <button pButton type="button" icon="pi pi-cog" class="p-button-rounded p-button-text" (click)="strategy(row)" pTooltip="Estrategia" tooltipPosition="top"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr><td colspan="5" class="text-center fs-sm text-muted">Sin datos</td></tr>
      </ng-template>
    </p-table>
  </div>
</div>
