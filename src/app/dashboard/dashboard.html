<div class="dashboard-header">
  <span class="dashboard-title">GUARDIAN</span>
</div>
<div class="dashboard-layout">
  <!-- Sidebar para desktop -->
  <aside class="sidebar desktop-only" [class.collapsed]="!sidebarExpanded">
    <div class="sidebar-header">
      <button class="sidebar-toggle" (click)="toggleSidebar()">
        <i class="pi" [ngClass]="sidebarExpanded ? 'pi-angle-left' : 'pi-angle-right'"></i>
      </button>
    </div>
    <nav class="sidebar-menu">
      <ul class="menu-list">
        <li *ngFor="let item of menu">
          <ng-container *ngIf="!item.children">
            <a [routerLink]="item.route" routerLinkActive="active" (click)="onNavigate()">
              <i [class]="item.icon"></i> <span>{{item.label}}</span>
            </a>
          </ng-container>
          <ng-container *ngIf="item.children">
            <div class="submenu-header" (click)="toggleSubmenu(item.label)">
              <i [class]="item.icon"></i> <span>{{item.label}}</span>
              <i class="pi" [ngClass]="{'pi-angle-down': activeSubmenu !== item.label, 'pi-angle-up': activeSubmenu === item.label}"></i>
            </div>
            <ul class="submenu-list" [ngClass]="{'open': activeSubmenu === item.label}">
              <li *ngFor="let sub of item.children">
                <a [routerLink]="sub.route" routerLinkActive="active" (click)="onNavigate()">{{sub.label}}</a>
              </li>
            </ul>
          </ng-container>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Sidebar PrimeNG para móvil -->
  <p-sidebar [(visible)]="sidebarMobileOpen" [modal]="true" [style]="{width: '80vw'}" [baseZIndex]="10000" position="left" class="mobile-only sidebar-mobile">
    <div class="sidebar-content">
      <ul class="menu-list">
        <li *ngFor="let item of menu">
          <ng-container *ngIf="!item.children">
            <a [routerLink]="item.route" routerLinkActive="active" (click)="onNavigate(true)">
              <i [class]="item.icon"></i> <span>{{item.label}}</span>
            </a>
          </ng-container>
          <ng-container *ngIf="item.children">
            <div class="submenu-header" (click)="toggleSubmenu(item.label)">
              <i [class]="item.icon"></i> <span>{{item.label}}</span>
              <i class="pi" [ngClass]="{'pi-angle-down': activeSubmenu !== item.label, 'pi-angle-up': activeSubmenu === item.label}"></i>
            </div>
            <ul class="submenu-list" [ngClass]="{'open': activeSubmenu === item.label}">
              <li *ngFor="let sub of item.children">
                <a [routerLink]="sub.route" routerLinkActive="active" (click)="onNavigate(true)">{{sub.label}}</a>
              </li>
            </ul>
          </ng-container>
        </li>
      </ul>
    </div>
  </p-sidebar>

  <main class="dashboard-main">
    <div class="dashboard-navbar">
      <button class="sidebar-hamburger-navbar mobile-only" (click)="sidebarMobileOpen ? closeSidebarMobile() : openSidebarMobile()">
        <i class="pi pi-bars"></i>
      </button>
      <div class="navbar-user">
        <span class="avatar-circle user-avatar" (click)="toggleUserMenu()">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="16" cy="16" r="16" fill="#e0e6ed"/>
            <path d="M16 17c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5zm0 2c-3.33 0-10 1.667-10 5v2h20v-2c0-3.333-6.67-5-10-5z" fill="#7a869a"/>
          </svg>
        </span>
        <div class="user-menu" *ngIf="showUserMenu">
          <div style="padding: 0.7rem 1.2rem 0.3rem 1.2rem; border-bottom: 1px solid #e0e6ed;">
            <div class="navbar-usuario" style="font-size:0.85rem; font-family:'Chakra Petch', 'Inter', 'Segoe UI', Arial, sans-serif; color:#7a869a; letter-spacing:1px; font-weight:500;">{{ correo }}</div>
            <div class="navbar-rol">{{ rol | titlecase }}</div>
          </div>
          <button class="user-menu-item" (click)="logout()">
            <i class="pi pi-sign-out"></i> Cerrar sesión
          </button>
        </div>
      </div>
    </div>
    <div class="dashboard-container">
      <router-outlet></router-outlet>
    </div>
  </main>
  <footer class="footer-flotante" style="font-size:0.75rem; font-family:'Chakra Petch', 'Inter', 'Segoe UI', Arial, sans-serif; color:#7a869a; letter-spacing:1px; font-weight:500;">
    ESTA APP FUE DESARROLLADA POR OT&CZ
  </footer>
</div>
