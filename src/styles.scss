/* Design tokens y temas (claro, oscuro, negro) */
:root.theme-light {
  --bg: #f4f7fa;
  --surface: #ffffff;
  --surface-alt: #ffffff; /* nueva: usada por tarjetas internas */
  --text: #23272f;
  --muted: #7a869a;
  --primary: #4f8cff;
  --primary-600: #2563eb;
  --secondary: #203a43;
  --border: #dbeafe;
  --success: #16a34a;
  --success-100: #e7f6ec;
  --danger: #e53e3e;
  --danger-100: #fff0f0;

  /* PrimeNG tokens - forzar texto negro en modo claro */
  --p-text-color: #000000;
  --p-inputtext-color: #000000;
  --p-inputtext-placeholder-color: #4b5563;
}
:root.theme-dark {
  --bg: #181824;
  --surface: #232336;
  --surface-alt: #1c1c2a; /* nueva: fondo ligeramente más profundo */
  --text: #e0e6ed;
  --muted: #9aa3b2;
  --primary: #6ba2ff;
  --primary-600: #4f8cff;
  --secondary: #0d2030;
  --border: #2e3445;
  --success: #2dd27b;
  --success-100: #0b2d1c;
  --danger: #ff6b6b;
  --danger-100: #3a1f1f;
}
:root.theme-black {
  --bg: #0b0b0b;
  --surface: #131313;
  --surface-alt: #161616; /* nueva */
  --text: #e6e6e6;
  --muted: #9a9a9a;
  --primary: #6ba2ff;
  --primary-600: #4f8cff;
  --secondary: #080b10;
  --border: #262626;
  --success: #2dd27b;
  --success-100: #0d2218;
  --danger: #ff6b6b;
  --danger-100: #2a1414;
}

/* Base */
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: var(--p-font-family, Inter, Segoe UI, Roboto, Arial, sans-serif); /* unificada con tema Prime */
  background: var(--bg);
  color: var(--text);
}
/* Asegurar que componentes e inputs nativos hereden tipografía del tema */
.p-component { font-family: inherit; }
input, select, textarea, button { font-family: inherit; }

/* Links, focus y helpers */
a { color: var(--primary); text-decoration: none; }
a:hover { text-decoration: underline; }
:focus-visible { outline: 3px solid color-mix(in srgb, var(--primary) 65%, white); outline-offset: 2px; }

/* Contenedores utilitarios */
.container { width: min(1024px, 92vw); margin: 0 auto; }
.card {
  background: var(--surface);
  border: none; /* borderless */
  border-radius: 14px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.08), 0 2px 8px rgba(79,140,255,0.06);
}
/* Elevación en hover para tarjetas */
.card:hover { box-shadow: 0 14px 32px rgba(0,0,0,0.12), 0 4px 14px rgba(79,140,255,0.10); }

/* Botones PrimeNG override básico */
.p-button { border: none; border-radius: 10px; }
.p-button.p-button-primary { background: linear-gradient(90deg, var(--primary) 60%, var(--secondary) 100%); }
.p-button.p-button-primary:hover { background: linear-gradient(90deg, var(--secondary) 0%, var(--primary) 100%); }

/* Inputs PrimeNG borderless con contorno por sombra */
.p-inputtext {
  background: var(--surface);
  border: none; /* borderless */
  border-radius: 10px;
  color: var(--text);
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--border) 60%, transparent);
  transition: box-shadow .15s ease, background .15s ease;
}
.p-inputtext:hover {
  background: color-mix(in srgb, var(--surface) 94%, var(--bg));
  box-shadow: inset 0 0 0 1.25px color-mix(in srgb, var(--primary) 18%, var(--border));
}
.p-inputtext:focus {
  /* halo + refuerzo de contorno sin usar border */
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary) 20%, transparent), inset 0 0 0 1.5px color-mix(in srgb, var(--primary) 50%, var(--border));
}

/* Dropdowns PrimeNG borderless */
.p-dropdown {
  background: var(--surface);
  border: none; /* borderless */
  border-radius: 10px;
  color: var(--text);
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--border) 60%, transparent);
  transition: box-shadow .15s ease, background .15s ease;
}
.p-dropdown:hover {
  background: color-mix(in srgb, var(--surface) 94%, var(--bg));
  box-shadow: inset 0 0 0 1.25px color-mix(in srgb, var(--primary) 18%, var(--border));
}
.p-dropdown.p-focus {
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary) 20%, transparent), inset 0 0 0 1.5px color-mix(in srgb, var(--primary) 50%, var(--border));
}
.p-dropdown-panel {
  background: var(--surface);
  border: none; /* borderless */
  box-shadow: 0 12px 28px rgba(0,0,0,0.18), 0 6px 12px rgba(79,140,255,0.10);
}
/* Items del panel con hover sin borde */
.p-dropdown-items .p-dropdown-item {
  border-radius: 8px;
}

/* Snackbar/toast base (si se usan) */
.snackbar { background: linear-gradient(90deg, var(--primary) 60%, var(--secondary) 100%); color: #fff; }
.snackbar.snackbar-error { background: linear-gradient(90deg, var(--danger) 60%, #7f1d1d 100%); }

/* Layout básicos para header y sidebar */
.header {
  height: 56px; display: flex; align-items: center; gap: 12px;
  padding: 0 16px; background: var(--secondary); color: #fff;
}
.header .spacer { flex: 1 1 auto; }
.sidebar { width: 260px; background: linear-gradient(135deg, var(--secondary) 0%, color-mix(in srgb, var(--secondary) 70%, black) 100%); color: #fff; }
.main { flex: 1; background: var(--bg); }

/* KPI cards */
.kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
.kpi { padding: 16px; }

/* Selector de tema (p-selectButton) */
.theme-select .p-buttonset .p-button,
.theme-select .p-selectbutton .p-button {
  border: none !important;
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--border) 60%, transparent);
}
.theme-select .p-button.p-highlight {
  box-shadow: inset 0 0 0 1.5px color-mix(in srgb, var(--primary) 60%, var(--border)), 0 4px 16px rgba(79,140,255,0.18);
}
.theme-select .p-button:focus-visible {
  outline: 3px solid color-mix(in srgb, var(--primary) 65%, white);
  outline-offset: 2px;
}
.theme-select .p-button:hover:not(.p-highlight) {
  background: color-mix(in srgb, var(--primary) 12%, var(--surface));
}

/* Tarjetas y cabeceras (look tecnológico) */
.card {
  border-radius: 14px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.08);
}
.header {
  background: linear-gradient(120deg, var(--secondary) 0%, color-mix(in srgb, var(--secondary) 70%, black) 100%);
}

/* Inputs: halo de seguridad al focus */
.p-inputtext:focus {
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary) 20%, transparent);
}

/* FAB de tema visible en todo el dashboard */
.theme-fab {
  position: fixed;
  right: 16px;
  bottom: 16px;
  z-index: 2000;
}
.theme-fab .p-button {
  width: 52px;
  height: 52px;
  border-radius: 50% !important;
  padding: 0 !important;
  background: linear-gradient(120deg, var(--primary) 0%, var(--secondary) 100%);
  color: #fff;
  box-shadow: 0 8px 24px rgba(0,0,0,0.18), 0 4px 12px rgba(79,140,255,0.18);
  transition: transform .15s ease, box-shadow .15s ease, background .2s ease;
}
.theme-fab .p-button:hover {
  transform: translateY(-1px);
  background: linear-gradient(120deg, var(--secondary) 0%, var(--primary) 100%);
  box-shadow: 0 12px 28px rgba(0,0,0,0.22), 0 6px 16px rgba(79,140,255,0.22);
}
.theme-fab .p-button:active { transform: translateY(0); }
.theme-fab .p-button span { display: none; }
.theme-fab .p-button .pi { font-size: 1.2rem; }

/* Botones: variantes y estados claros */
.p-button { font-weight: 700; letter-spacing: .2px; }
.p-button.p-button-text { background: transparent; color: var(--text); }
.p-button.p-button-text:hover { background: color-mix(in srgb, var(--primary) 12%, transparent); }
.p-button.p-button-rounded { border-radius: 999px; }
/* Variantes semánticas */
.p-button.p-button-success { background: linear-gradient(90deg, var(--success) 60%, #138a4f 100%); color:#fff; }
.p-button.p-button-success:hover { background: linear-gradient(90deg, #138a4f 0%, var(--success) 100%); }
.p-button.p-button-danger { background: linear-gradient(90deg, var(--danger) 60%, #7f1d1d 100%); color:#fff; }
.p-button.p-button-danger:hover { background: linear-gradient(90deg, #7f1d1d 0%, var(--danger) 100%); }
.p-button.p-button-outlined { background: transparent; border:1px solid var(--border); color: var(--text); }
.p-button.p-button-outlined:hover { background: color-mix(in srgb, var(--primary) 10%, transparent); }
.p-button:disabled, .p-button.p-disabled { opacity: .6; cursor: not-allowed; box-shadow: none; }

/* Inputs: estados, placeholders y accesibilidad */
.p-inputtext::placeholder { color: color-mix(in srgb, var(--muted) 80%, white); opacity: 1; }
.p-inputtext:disabled { background: color-mix(in srgb, var(--surface) 70%, var(--bg)); color: var(--muted); }
/* Invalid PrimeNG */
.p-inputtext.p-invalid, .p-element.p-invalid .p-inputtext { box-shadow: 0 0 0 3px color-mix(in srgb, var(--danger) 20%, transparent) !important; }
/* Invalid Angular */
.ng-invalid.ng-touched .p-inputtext { box-shadow: 0 0 0 3px color-mix(in srgb, var(--danger) 20%, transparent) !important; }

/* Campos con etiqueta y ayuda (si se usan) */
.form-field { display: flex; flex-direction: column; gap: 6px; }
.form-field label { font-weight: 600; color: var(--text); text-transform: none; font-size: .86rem; letter-spacing: .2px; }
.form-field .helper { font-size: .86rem; color: var(--muted); }

/* También normalizar etiquetas usadas en componentes que emplean .field */
.field label { text-transform: none; font-size: .86rem; letter-spacing: .2px; color: var(--text); }

/* Glass/blur header */
.header {
  background: linear-gradient(120deg, color-mix(in srgb, var(--secondary) 70%, transparent) 0%, color-mix(in srgb, var(--secondary) 40%, transparent) 100%);
  backdrop-filter: blur(10px) saturate(140%);
  -webkit-backdrop-filter: blur(10px) saturate(140%);
  border-bottom: 1px solid color-mix(in srgb, var(--border) 60%, transparent);
}

/* Animación al cambiar de tema */
@keyframes theme-fade {
  0% { opacity: .2; filter: saturate(85%); }
  100% { opacity: 1; filter: saturate(100%); }
}
.theme-change body,
.theme-change .main,
.theme-change .header,
.theme-change .sidebar,
.theme-change .card {
  animation: theme-fade .35s ease both;
}

/* Micro-animaciones: KPIs y filas de tabla */
.kpi { transition: transform .15s ease, box-shadow .15s ease; }
.kpi:hover { transform: translateY(-2px); box-shadow: 0 10px 28px rgba(0,0,0,0.12), 0 6px 16px rgba(79,140,255,0.15); }
/* PrimeNG Table hover */
.p-datatable .p-datatable-wrapper table tbody tr:hover,
.p-table .p-datatable-wrapper table tbody tr:hover,
.p-table table tbody tr:hover {
  background: color-mix(in srgb, var(--primary) 8%, transparent) !important;
}

/* Tamaños confortables (inputs, dropdowns, botones) */
.p-inputtext {
  min-height: 48px;
  padding: 10px 14px;
  font-size: 1.02rem;
}
.p-dropdown {
  min-height: 48px;
  padding: 2px 12px;
  font-size: 1.02rem;
}
.p-dropdown .p-dropdown-label {
  padding: 10px 0;
}
.p-button {
  min-height: 48px;
  padding: 12px 18px;
  font-size: 1.02rem;
}
/* Botón flotante mantiene tamaño compacto */
.theme-fab .p-button { min-height: 52px; padding: 0; font-size: 1rem; }

/* Intensificar glows por tema y estado */
:root.theme-light {
  /* Halo azul más visible en foco (inputs/dropdowns) — menos grueso */
  .p-inputtext:focus,
  .p-dropdown.p-focus {
    box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary) 28%, transparent), inset 0 0 0 1.5px color-mix(in srgb, var(--primary) 55%, var(--border));
  }
  /* Tarjetas con sutil glow azul en hover */
  .card:hover {
    box-shadow: 0 14px 32px rgba(0,0,0,0.12), 0 6px 18px rgba(79,140,255,0.18), 0 0 0 2px color-mix(in srgb, var(--primary) 10%, transparent);
  }
}

/* Rojo que brilla — estados de error más intensos pero menos grueso */
.p-inputtext.p-invalid,
.p-element.p-invalid .p-inputtext,
.ng-invalid.ng-touched .p-inputtext {
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--danger) 28%, transparent), inset 0 0 0 1.5px var(--danger) !important;
}
/* Dropdown inválido (cuando aplique la clase de PrimeNG) */
.p-dropdown.p-invalid {
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--danger) 28%, transparent), inset 0 0 0 1.5px var(--danger) !important;
}
/* Snackbar de error con el mismo borde que los botones y tipografía más gruesa */
.snackbar.snackbar-error {
  border-radius: 10px; /* mismo borde que p-button */
  font-weight: 800;    /* etiqueta más gruesa */
  padding: 14px 20px;  /* un poco más de presencia */
}

/* Revertir inputs y dropdowns al estilo del tema por defecto */
.p-inputtext,
.p-inputtextarea {
  background: unset !important;
  border: unset !important;
  box-shadow: unset !important;
  border-radius: unset !important;
}
.p-inputtext:hover,
.p-inputtext:focus {
  box-shadow: unset !important;
}
.p-dropdown {
  background: unset !important;
  border: unset !important;
  box-shadow: unset !important;
  border-radius: unset !important;
}
.p-dropdown:hover,
.p-dropdown.p-focus {
  box-shadow: unset !important;
}

/* Tipografía blanca en inputs/dropdowns para temas oscuro y negro */
:root.theme-dark, :root.theme-black {
  .p-inputtext,
  .p-inputtextarea,
  .p-password input,
  .p-dropdown .p-dropdown-label {
    color: #ffffff !important;
  }
  .p-inputtext::placeholder,
  .p-inputtextarea::placeholder {
    color: rgba(255,255,255,0.75) !important;
  }
}

/* Tabla 'Actividad reciente' en modo claro (scoped a app-dashboard) */
:root.theme-light app-dashboard .recent-activity .p-datatable-wrapper table {
  background: var(--surface) !important;
  color: #000 !important;
}
:root.theme-light app-dashboard .recent-activity .p-datatable-thead > tr > th {
  background: color-mix(in srgb, var(--surface) 96%, var(--primary) 4%) !important;
  color: #000 !important;
  border-bottom: 1px solid var(--border) !important;
  font-weight: 700 !important;
}
:root.theme-light app-dashboard .recent-activity .p-datatable-tbody > tr > td {
  background: var(--surface) !important;
  color: #000 !important;
  border-top: 1px solid var(--border) !important;
}
:root.theme-light app-dashboard .recent-activity {
  border-radius: 12px;
  overflow: hidden;
}

/* Refuerzo final para login en tema claro: texto/caret negros y placeholder gris */
:root.theme-light app-login input:not([type="checkbox"]):not([type="radio"]),
:root.theme-light app-login .p-inputtext,
:root.theme-light app-login .p-password input,
:root.theme-light app-login textarea {
  color: #000 !important;
  caret-color: #000 !important;
}
:root.theme-light app-login input::placeholder,
:root.theme-light app-login textarea::placeholder,
:root.theme-light app-login .p-inputtext::placeholder {
  color: #4b5563 !important; /* gris legible */
}

/* Refuerzo global: texto negro por defecto en modo claro */
:root.theme-light body,
:root.theme-light body .p-component {
  color: #000 !important;
}

/* Tema claro: p-dropdown con fondo blanco y texto negro + efectos */
:root.theme-light body .p-dropdown {
  background: #ffffff !important;
  color: #000 !important;
  border: none !important;
  border-radius: 10px !important;
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--border) 60%, transparent) !important;
}
:root.theme-light body .p-dropdown:hover {
  background: color-mix(in srgb, var(--surface) 96%, var(--bg)) !important;
  box-shadow: inset 0 0 0 1.25px color-mix(in srgb, var(--primary) 18%, var(--border)) !important;
}
:root.theme-light body .p-dropdown.p-focus {
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary) 20%, transparent), inset 0 0 0 1.5px color-mix(in srgb, var(--primary) 50%, var(--border)) !important;
}
:root.theme-light body .p-dropdown .p-dropdown-label { color: #000 !important; }
:root.theme-light body .p-dropdown .p-dropdown-label.p-placeholder { color: #4b5563 !important; }

/* Panel del dropdown en tema claro (base) */
:root.theme-light body .p-dropdown-panel {
  background: #ffffff !important;
  color: #000 !important;
  border: none !important;
  box-shadow: 0 12px 28px rgba(0,0,0,0.18), 0 6px 12px rgba(79,140,255,0.10) !important;
}
:root.theme-light body .p-dropdown-panel .p-dropdown-item { color: #000 !important; border-radius: 8px; }
:root.theme-light body .p-dropdown-panel .p-dropdown-item.p-highlight { background: color-mix(in srgb, var(--primary) 14%, transparent) !important; color: #000 !important; }
:root.theme-light body .p-dropdown-panel .p-dropdown-item:not(.p-highlight):hover { background: color-mix(in srgb, var(--primary) 10%, transparent) !important; }

/* Tema claro: control específico blanco para Tipo de documento */
:root.theme-light body .doc-type-control.p-dropdown {
  background: #ffffff !important;
  color: #000 !important;
  border: none !important;
  border-radius: 10px !important;
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--border) 60%, transparent) !important;
}
:root.theme-light body .doc-type-control.p-dropdown:hover {
  background: color-mix(in srgb, var(--surface) 96%, var(--bg)) !important;
}
:root.theme-light body .doc-type-control.p-dropdown .p-dropdown-label { color: #000 !important; }
:root.theme-light body .doc-type-control.p-dropdown .p-dropdown-label.p-placeholder { color: #4b5563 !important; }

/* FIX definitivo: panel del dropdown con clase en el propio .p-dropdown-panel (opciones verdes) */
:root.theme-light body .p-dropdown-panel.doc-type-panel { background: #ffffff !important; color: #000 !important; border: none !important; box-shadow: 0 12px 28px rgba(0,0,0,0.18), 0 6px 12px rgba(79,140,255,0.10) !important; }
:root.theme-light body .p-dropdown-panel.doc-type-panel .p-dropdown-items-wrapper { background: #ffffff !important; }
:root.theme-light body .p-dropdown-panel.doc-type-panel .p-dropdown-items { padding: 8px !important; background: #ffffff !important; }
:root.theme-light body .p-dropdown-panel.doc-type-panel .p-dropdown-item { background: var(--success) !important; color: #ffffff !important; border-radius: 10px; margin: 4px 0; }
:root.theme-light body .p-dropdown-panel.doc-type-panel .p-dropdown-item:hover { background: color-mix(in srgb, var(--success) 85%, black) !important; }
:root.theme-light body .p-dropdown-panel.doc-type-panel .p-dropdown-item.p-highlight { background: color-mix(in srgb, var(--success) 75%, black) !important; color: #ffffff !important; }

/* Extensiones para clases p-select-* (PrimeNG 18) */
:root.theme-light body .p-select-panel {
  background: #ffffff !important;
  color: #000 !important;
  border: none !important;
  box-shadow: 0 12px 28px rgba(0,0,0,0.18), 0 6px 12px rgba(79,140,255,0.10) !important;
}
:root.theme-light body .p-select-panel .p-select-item { color: #000 !important; border-radius: 8px; }
:root.theme-light body .p-select-panel .p-select-item.p-highlight { background: color-mix(in srgb, var(--primary) 14%, transparent) !important; color: #000 !important; }
:root.theme-light body .p-select-panel .p-select-item:not(.p-highlight):hover { background: color-mix(in srgb, var(--primary) 10%, transparent) !important; }

/* Control específico 'Tipo de documento' (label negro si la clase cambia) */
:root.theme-light body .doc-type-control .p-select-label { color: #000 !important; }

/* Panel verde para doc-type también con p-select-panel */
:root.theme-light body .p-select-panel.doc-type-panel { background: #ffffff !important; color: #000 !important; }
:root.theme-light body .p-select-panel.doc-type-panel .p-select-items-wrapper { background: #ffffff !important; }
:root.theme-light body .p-select-panel.doc-type-panel .p-select-items { padding: 8px !important; background: #ffffff !important; }
:root.theme-light body .p-select-panel.doc-type-panel .p-select-item { background: var(--success) !important; color: #ffffff !important; border-radius: 10px; margin: 4px 0; }
:root.theme-light body .p-select-panel.doc-type-panel .p-select-item:hover { background: color-mix(in srgb, var(--success) 85%, black) !important; }
:root.theme-light body .p-select-panel.doc-type-panel .p-select-item.p-highlight { background: color-mix(in srgb, var(--success) 75%, black) !important; color: #ffffff !important; }

/* Tema claro: panel del p-dropdown (solo para selector de documento) */
:root.theme-light .p-dropdown-panel.doc-type-panel {
  background: #ffffff !important;
  color: #000 !important;
  border: 1px solid var(--border) !important;
  box-shadow: 0 12px 28px rgba(0,0,0,0.12), 0 4px 10px rgba(79,140,255,0.10) !important;
}
:root.theme-light .p-dropdown-panel.doc-type-panel .p-dropdown-items {
  background: transparent !important;
}
:root.theme-light .p-dropdown-panel.doc-type-panel .p-dropdown-item {
  color: #000 !important;
}
:root.theme-light .p-dropdown-panel.doc-type-panel .p-dropdown-item.p-highlight {
  background: color-mix(in srgb, var(--primary) 18%, #ffffff) !important;
  color: #000 !important;
}
:root.theme-light .p-dropdown-panel.doc-type-panel .p-dropdown-item:not(.p-highlight):hover {
  background: color-mix(in srgb, var(--primary) 12%, #ffffff) !important;
}

/* ===== Encabezado de tabla (thead) en modo claro (global) ===== */
:root.theme-light body .p-datatable-thead > tr > th,
:root.theme-light body .p-table .p-datatable-thead > tr > th {
  background: color-mix(in srgb, var(--surface) 96%, var(--primary) 4%) !important;
  color: #000 !important;
  border-bottom: 1px solid var(--border) !important;
}

/* ===== Tablas en modo oscuro / negro (unificar look) ===== */
:root.theme-dark app-dashboard .recent-activity .p-datatable-wrapper table,
:root.theme-black app-dashboard .recent-activity .p-datatable-wrapper table,
:root.theme-dark .p-datatable .p-datatable-wrapper table,
:root.theme-black .p-datatable .p-datatable-wrapper table {
  background: var(--surface) !important;
  color: var(--text) !important;
}
:root.theme-dark app-dashboard .recent-activity .p-datatable-thead > tr > th,
:root.theme-black app-dashboard .recent-activity .p-datatable-thead > tr > th,
:root.theme-dark .p-datatable-thead > tr > th,
:root.theme-black .p-datatable-thead > tr > th {
  background: linear-gradient(180deg, color-mix(in srgb, var(--surface) 94%, var(--secondary) 6%), color-mix(in srgb, var(--surface) 88%, var(--secondary) 12%)) !important;
  color: var(--text) !important;
  border-bottom: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
}
:root.theme-dark app-dashboard .recent-activity .p-datatable-tbody > tr > td,
:root.theme-black app-dashboard .recent-activity .p-datatable-tbody > tr > td,
:root.theme-dark .p-datatable-tbody > tr > td,
:root.theme-black .p-datatable-tbody > tr > td {
  background: color-mix(in srgb, var(--surface) 98%, black) !important;
  color: var(--text) !important;
  border-top: 1px solid color-mix(in srgb, var(--border) 55%, transparent) !important;
}
:root.theme-dark .p-datatable-tbody > tr:nth-child(even) > td,
:root.theme-black .p-datatable-tbody > tr:nth-child(even) > td {
  background: color-mix(in srgb, var(--surface) 92%, black) !important;
}
:root.theme-dark .p-datatable-tbody > tr:hover > td,
:root.theme-black .p-datatable-tbody > tr:hover > td,
:root.theme-dark app-dashboard .recent-activity .p-datatable-tbody > tr:hover > td,
:root.theme-black app-dashboard .recent-activity .p-datatable-tbody > tr:hover > td {
  background: color-mix(in srgb, var(--primary) 14%, var(--surface)) !important;
  transition: background .15s ease;
}
:root.theme-dark .p-datatable.p-datatable-gridlines .p-datatable-tbody > tr > td,
:root.theme-black .p-datatable.p-datatable-gridlines .p-datatable-tbody > tr > td {
  border-color: color-mix(in srgb, var(--border) 40%, transparent) !important;
}
/* Scrollbar sutil dentro de tablas en modo oscuro */
:root.theme-dark .p-datatable-wrapper::-webkit-scrollbar,
:root.theme-black .p-datatable-wrapper::-webkit-scrollbar { height: 10px; width: 10px; }
:root.theme-dark .p-datatable-wrapper::-webkit-scrollbar-track,
:root.theme-black .p-datatable-wrapper::-webkit-scrollbar-track { background: color-mix(in srgb, var(--surface) 85%, black); }
:root.theme-dark .p-datatable-wrapper::-webkit-scrollbar-thumb,
:root.theme-black .p-datatable-wrapper::-webkit-scrollbar-thumb { background: color-mix(in srgb, var(--primary) 35%, var(--secondary)); border-radius: 6px; }
:root.theme-dark .p-datatable-wrapper::-webkit-scrollbar-thumb:hover,
:root.theme-black .p-datatable-wrapper::-webkit-scrollbar-thumb:hover { background: color-mix(in srgb, var(--primary) 50%, var(--secondary)); }

/* Tag de cabecera sticky (opcional: mejora contraste en dark) */
:root.theme-dark .p-datatable-header,
:root.theme-black .p-datatable-header {
  background: color-mix(in srgb, var(--surface) 90%, var(--secondary) 10%) !important;
  border: 1px solid color-mix(in srgb, var(--border) 55%, transparent) !important;
  color: var(--text) !important;
}

/* Ajustes para paginator en modo oscuro */
:root.theme-dark .p-paginator,
:root.theme-black .p-paginator { background: var(--surface) !important; border: 1px solid color-mix(in srgb, var(--border) 60%, transparent); }
:root.theme-dark .p-paginator .p-paginator-page,
:root.theme-black .p-paginator .p-paginator-page { color: var(--text); }
:root.theme-dark .p-paginator .p-paginator-page.p-highlight,
:root.theme-black .p-paginator .p-paginator-page.p-highlight { background: color-mix(in srgb, var(--primary) 25%, var(--surface)) !important; color: var(--text) !important; }

/* ===== Paginador en modo claro (global) ===== */
:root.theme-light body .p-paginator {
  background: var(--surface) !important;
  color: #000 !important;
  border: 1px solid var(--border) !important;
}
:root.theme-light body .p-paginator .p-paginator-page,
:root.theme-light body .p-paginator .p-paginator-pages .p-paginator-page {
  color: #000 !important;
}
:root.theme-light body .p-paginator .p-paginator-page.p-highlight,
:root.theme-light body .p-paginator .p-paginator-pages .p-paginator-page.p-highlight {
  background: color-mix(in srgb, var(--primary) 12%, #ffffff) !important;
  color: #000 !important;
}
:root.theme-light body .p-paginator .p-paginator-first,
:root.theme-light body .p-paginator .p-paginator-prev,
:root.theme-light body .p-paginator .p-paginator-next,
:root.theme-light body .p-paginator .p-paginator-last {
  color: #000 !important;
}
:root.theme-light body .p-paginator .p-dropdown {
  background: #ffffff !important;
  color: #000 !important;
  border: 1px solid var(--border) !important;
}

/* ===== REFORZADO: tamaños y colores del InputSwitch con !important ===== */
.p-inputswitch .p-inputswitch-slider { width: 42px !important; height: 22px !important; }
.p-inputswitch .p-inputswitch-handle { transform: none !important; }
:root.theme-dark .toggle-item .p-inputswitch .p-inputswitch-slider {
  background: #3a3d44 !important; /* OFF en dark */
  background-color: #3a3d44 !important;
  border-color: #555a65 !important;
}
:root.theme-dark .toggle-item .p-inputswitch.p-inputswitch-checked .p-inputswitch-slider {
  background: color-mix(in srgb, var(--success) 72%, var(--surface) 28%) !important;
  background-color: color-mix(in srgb, var(--success) 72%, var(--surface) 28%) !important;
  border-color: color-mix(in srgb, var(--success) 70%, var(--border)) !important;
}
:root.theme-light .toggle-item .p-inputswitch .p-inputswitch-slider {
  background: #f3f4f6 !important; /* OFF en light */
  background-color: #f3f4f6 !important;
  border-color: rgba(0,0,0,.12) !important;
}

/* === PrimeNG Toast: alineado a paleta de colores === */
body .p-toast {
  z-index: 3000; /* sobre paneles */
}
body .p-toast .p-toast-message {
  border: none;
  border-radius: 12px;
  color: #fff;
  box-shadow: 0 12px 28px rgba(0,0,0,0.24), 0 6px 12px rgba(0,0,0,0.18);
}
body .p-toast .p-toast-message .p-toast-message-content { padding: 12px 16px; }
body .p-toast .p-toast-summary { font-weight: 800; letter-spacing: .3px; }
body .p-toast .p-toast-detail { opacity: .98; }
body .p-toast .p-toast-message .p-toast-icon-close { color: #fff; opacity: .9; }

/* Severidades con degradados según tokens del tema */
body .p-toast .p-toast-message-success {
  background: linear-gradient(90deg, var(--success) 60%, #138a4f 100%);
}
body .p-toast .p-toast-message-error {
  background: linear-gradient(90deg, var(--danger) 60%, #7f1d1d 100%);
}
body .p-toast .p-toast-message-warn {
  /* usar --warning si existe, si no fallback a un ámbar accesible */
  background: linear-gradient(90deg, var(--warning, #f59e0b) 60%, color-mix(in srgb, var(--warning, #f59e0b) 65%, #7a4b00) 100%);
}
body .p-toast .p-toast-message-info {
  background: linear-gradient(90deg, var(--primary) 60%, var(--secondary) 100%);
}

/* Asegurar contraste en temas oscuros */
:root.theme-dark body .p-toast .p-toast-message,
:root.theme-black body .p-toast .p-toast-message { color: #fff; }

/* Posiciones: top-center ya se setea desde el componente */
/* Fin Toast overrides */

/* === Overrides globales para p-dropdown en temas oscuros (panel) === */
:root.theme-dark body .p-dropdown-panel,
:root.theme-black body .p-dropdown-panel {
  background: color-mix(in srgb, var(--surface) 92%, #000) !important;
  border: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
  color: #fff !important;
}
:root.theme-dark body .p-dropdown-panel .p-dropdown-header,
:root.theme-black body .p-dropdown-panel .p-dropdown-header {
  background: color-mix(in srgb, var(--surface) 92%, #000) !important;
  border-bottom: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
}
:root.theme-dark body .p-dropdown-panel .p-dropdown-header .p-inputtext,
:root.theme-black body .p-dropdown-panel .p-dropdown-header .p-inputtext,
:root.theme-dark body .p-dropdown-panel .p-dropdown-filter,
:root.theme-black body .p-dropdown-panel .p-dropdown-filter {
  background: color-mix(in srgb, var(--surface) 88%, #000) !important;
  color: #fff !important;
  border: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
}
:root.theme-dark body .p-dropdown-panel .p-dropdown-header .p-inputtext::placeholder,
:root.theme-black body .p-dropdown-panel .p-dropdown-header .p-inputtext::placeholder { color: #fff !important; opacity: .75; }
:root.theme-dark body .p-dropdown-panel .p-dropdown-filter-icon,
:root.theme-black body .p-dropdown-panel .p-dropdown-filter-icon { color: #fff !important; opacity: .9; }

:root.theme-dark body .p-dropdown-panel .p-dropdown-items,
:root.theme-black body .p-dropdown-panel .p-dropdown-items { background: transparent !important; }
:root.theme-dark body .p-dropdown-panel .p-dropdown-item,
:root.theme-black body .p-dropdown-panel .p-dropdown-item { color: #fff !important; }
:root.theme-dark body .p-dropdown-panel .p-dropdown-item.p-highlight,
:root.theme-black body .p-dropdown-panel .p-dropdown-item.p-highlight { background: color-mix(in srgb, var(--primary) 22%, transparent) !important; }
:root.theme-dark body .p-dropdown-panel .p-dropdown-item:not(.p-highlight):hover,
:root.theme-black body .p-dropdown-panel .p-dropdown-item:not(.p-highlight):hover { background: color-mix(in srgb, var(--primary) 16%, transparent) !important; }
/* === Fin overrides dropdown oscuro === */

/* Refuerzo contenedores internos del panel (evitar fondos blancos residuales) */
:root.theme-dark body .p-dropdown-panel .p-dropdown-content,
:root.theme-black body .p-dropdown-panel .p-dropdown-content,
:root.theme-dark body .p-dropdown-panel .p-dropdown-items-wrapper,
:root.theme-black body .p-dropdown-panel .p-dropdown-items-wrapper { background: color-mix(in srgb, var(--surface) 92%, #000) !important; }

/* === Overrides globales para p-select-overlay en temas oscuros === */
:root.theme-dark body .p-select-overlay,
:root.theme-black body .p-select-overlay {
  background: color-mix(in srgb, var(--surface) 92%, #000) !important;
  border: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
  color: #fff !important;
}
:root.theme-dark body .p-select-overlay .p-select-header,
:root.theme-black body .p-select-overlay .p-select-header {
  background: color-mix(in srgb, var(--surface) 92%, #000) !important;
  border-bottom: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
}
:root.theme-dark body .p-select-overlay .p-inputtext,
:root.theme-black body .p-select-overlay .p-inputtext,
:root.theme-dark body .p-select-overlay .p-select-filter,
:root.theme-black body .p-select-overlay .p-select-filter {
  background: color-mix(in srgb, var(--surface) 88%, #000) !important;
  color: #fff !important;
  border: 1px solid color-mix(in srgb, var(--border) 70%, transparent) !important;
}
:root.theme-dark body .p-select-overlay .p-inputtext::placeholder,
:root.theme-black body .p-select-overlay .p-inputtext::placeholder { color: #fff !important; opacity: .75; }
:root.theme-dark body .p-select-overlay .p-select-filter-icon,
:root.theme-black body .p-select-overlay .p-select-filter-icon { color: #fff !important; opacity: .9; }

:root.theme-dark body .p-select-overlay .p-select-items,
:root.theme-black body .p-select-overlay .p-select-items,
:root.theme-dark body .p-select-overlay .p-select-items-wrapper,
:root.theme-black body .p-select-overlay .p-select-items-wrapper { background: transparent !important; }

/* Cubrir tanto nomenclatura antigua (.p-select-item) como nueva (.p-select-option) */
:root.theme-dark body .p-select-overlay .p-select-item,
:root.theme-black body .p-select-overlay .p-select-item,
:root.theme-dark body .p-select-overlay .p-select-option,
:root.theme-black body .p-select-overlay .p-select-option { color: #fff !important; }

:root.theme-dark body .p-select-overlay .p-select-item.p-highlight,
:root.theme-black body .p-select-overlay .p-select-item.p-highlight,
:root.theme-dark body .p-select-overlay .p-select-option.p-highlight,
:root.theme-black body .p-select-overlay .p-select-option.p-highlight { background: color-mix(in srgb, var(--primary) 22%, transparent) !important; }

:root.theme-dark body .p-select-overlay .p-select-item:not(.p-highlight):hover,
:root.theme-black body .p-select-overlay .p-select-item:not(.p-highlight):hover,
:root.theme-dark body .p-select-overlay .p-select-option:not(.p-highlight):hover,
:root.theme-black body .p-select-overlay .p-select-option:not(.p-highlight):hover { background: color-mix(in srgb, var(--primary) 16%, transparent) !important; }
/* === Fin overrides p-select-overlay oscuro === */

/* === Overrides globales para p-select-overlay en tema claro === */
:root.theme-light body .p-select-overlay {
  background: #ffffff !important;
  color: #000 !important;
  border: 1px solid var(--border) !important;
  box-shadow: 0 12px 28px rgba(0,0,0,0.12), 0 4px 10px rgba(79,140,255,0.10) !important;
}
:root.theme-light body .p-select-overlay .p-select-header {
  background: #ffffff !important;
  color: #000 !important;
  border-bottom: 1px solid var(--border) !important;
}
:root.theme-light body .p-select-overlay .p-inputtext,
:root.theme-light body .p-select-overlay .p-select-filter {
  background: #ffffff !important;
  color: #000 !important;
  border: 1px solid var(--border) !important;
}
:root.theme-light body .p-select-overlay .p-inputtext::placeholder { color: #4b5563 !important; }
:root.theme-light body .p-select-overlay .p-select-items,
:root.theme-light body .p-select-overlay .p-select-items-wrapper { background: transparent !important; }
:root.theme-light body .p-select-overlay .p-select-item,
:root.theme-light body .p-select-overlay .p-select-option { color: #000 !important; }
:root.theme-light body .p-select-overlay .p-select-item.p-highlight,
:root.theme-light body .p-select-overlay .p-select-option.p-highlight { background: color-mix(in srgb, var(--primary) 14%, transparent) !important; color: #000 !important; }
:root.theme-light body .p-select-overlay .p-select-item:not(.p-highlight):hover,
:root.theme-light body .p-select-overlay .p-select-option:not(.p-highlight):hover { background: color-mix(in srgb, var(--primary) 10%, transparent) !important; }

/* === Reglas específicas para overlays insertados (.ng-star-inserted) === */
/* Limitar a paneles PrimeNG para evitar efectos colaterales */
:root.theme-light body .ng-star-inserted.p-select-overlay,
:root.theme-light body .ng-star-inserted.p-dropdown-panel,
:root.theme-light body .ng-star-inserted.p-multiselect-panel {
  background: #ffffff !important;
  color: #000 !important;
}
:root.theme-dark body .ng-star-inserted.p-select-overlay,
:root.theme-dark body .ng-star-inserted.p-dropdown-panel,
:root.theme-dark body .ng-star-inserted.p-multiselect-panel,
:root.theme-black body .ng-star-inserted.p-select-overlay,
:root.theme_black body .ng-star-inserted.p-dropdown-panel,
:root.theme_black body .ng-star-inserted.p-multiselect-panel {
  background: color-mix(in srgb, var(--surface) 92%, #000) !important;
  color: #fff !important;
}

/* ===== Tablas en modo claro (global) ===== */
:root.theme-light body .p-datatable .p-datatable-wrapper table,
:root.theme-light body .p-table .p-datatable-wrapper table {
  background: var(--surface) !important;
  color: #000 !important;
}
:root.theme-light body .p-datatable-tbody > tr > td,
:root.theme-light body .p-table .p-datatable-tbody > tr > td {
  background: var(--surface) !important;
  color: #000 !important;
  border-top: 1px solid var(--border) !important;
}
:root.theme-light body .p-datatable-tbody > tr:nth-child(even) > td,
:root.theme-light body .p-table .p-datatable-tbody > tr:nth-child(even) > td {
  background: var(--surface) !important; /* sin bandas para look limpio */
}
:root.theme-light body .p-datatable .p-datatable-wrapper table tbody tr:hover > td,
:root.theme-light body .p-table .p-datatable-wrapper table tbody tr:hover > td {
  background: color-mix(in srgb, var(--primary) 8%, #ffffff) !important;
}

/* Tema claro: asegurar label negro para el control Sección Padre */
:root.theme-light body .seccion-padre-control.p-dropdown .p-dropdown-label { color: #000 !important; }
:root.theme-light body .seccion-padre-control.p-dropdown .p-dropdown-label.p-placeholder { color: #4b5563 !important; }

/* Tema claro: refuerzo adicional para el texto del label (y su span interno) */
:root.theme-light body .seccion-padre-control .p-dropdown-label,
:root.theme-light body .seccion-padre-control .p-dropdown-label span { color: #000 !important; }

/* ===== Popover (PrimeNG) en modo claro ===== */
:root.theme-light body .p-popover {
  background: #ffffff !important;
  color: #111 !important;
  border: 1px solid var(--border) !important;
  box-shadow: 0 14px 32px rgba(0,0,0,0.12), 0 6px 18px rgba(79,140,255,0.12) !important;
}
:root.theme-light body .p-popover .p-popover-content {
  background: transparent !important;
  color: inherit !important;
  font-size: 0.95rem; /* un poco más alto */
}
:root.theme-light body .p-popover .p-popover-arrow {
  border-right-color: #ffffff !important;
  border-left-color: #ffffff !important;
}

/* ===== ConfirmDialog global (usa tokens del tema) ===== */
body .p-confirm-dialog.p-dialog {
  background: var(--surface) !important;
  color: var(--text) !important;
  border: 1px solid var(--border) !important;
}
body .p-confirm-dialog .p-dialog-header,
body .p-confirm-dialog .p-dialog-content,
body .p-confirm-dialog .p-dialog-footer {
  background: var(--surface) !important;
  color: var(--text) !important;
}
body .p-confirm-dialog .p-dialog-header { border-bottom: 1px solid var(--border) !important; }
body .p-confirm-dialog .p-dialog-footer { border-top: 1px solid var(--border) !important; }
body .p-confirm-dialog .p-confirm-dialog-message,
body .p-confirm-dialog .p-confirm-dialog-message * { color: var(--text) !important; }
body .p-confirm-dialog .p-confirm-dialog-icon { color: var(--danger) !important; }

/* ===== Correcciones de selectores mal escritos (tema oscuro/negro) ===== */
:root.theme-dark body .ng-star-inserted.p-select-overlay,
:root.theme-dark body .ng-star-inserted.p-dropdown-panel,
:root.theme-dark body .ng-star-inserted.p-multiselect-panel,
:root.theme-black body .ng-star-inserted.p-select-overlay,
:root.theme-black body .ng-star-inserted.p-dropdown-panel,
:root.theme-black body .ng-star-inserted.p-multiselect-panel {
  background: color-mix(in srgb, var(--surface) 92%, #000) !important;
  color: #fff !important;
}

/* ===== Tokens de PrimeNG para Dialog por tema ===== */
:root.theme-light {
  --p-dialog-background: #ffffff;
  --p-dialog-header-background: #ffffff;
  --p-dialog-content-background: #ffffff;
  --p-dialog-text-color: #000000;
}
:root.theme-dark, :root.theme-black {
  --p-dialog-background: var(--surface);
  --p-dialog-header-background: var(--surface);
  --p-dialog-content-background: var(--surface);
  --p-dialog-text-color: var(--text);
}

/* ===== Refuerzo FINAL: .p-dialog en modo claro (máxima especificidad) ===== */
:root.theme-light body .p-dialog,
:root.theme-light body .p-confirm-dialog.p-dialog {
  background-color: #ffffff !important;
  color: #000000 !important;
  border: 1px solid var(--border) !important;
  box-shadow: 0 14px 32px rgba(0,0,0,0.12), 0 6px 18px rgba(79,140,255,0.12) !important;
}
:root.theme-light body .p-dialog .p-dialog-header,
:root.theme-light body .p_dialog .p-dialog-content,
:root.theme-light body .p_dialog .p-dialog-footer {
  background-color: #ffffff !important;
  color: #000000 !important;
}
:root.theme-light body .p_dialog .p-dialog-header { border-bottom: 1px solid var(--border) !important; }
:root.theme-light body .p_dialog .p-dialog-footer { border-top: 1px solid var(--border) !important; }
:root.theme-light body .p-confirm-dialog .p-confirm-dialog-message,
:root.theme-light body .p-confirm-dialog .p-confirm-dialog-message * { color: #000000 !important; }

/* ===== Refuerzo overlay/máscara ===== */
:root.theme-light body .p-dialog-mask { background-color: rgba(0,0,0,.35) !important; }
:root.theme-dark body .p-dialog-mask, :root.theme-black body .p-dialog-mask { background-color: rgba(0,0,0,.6) !important; }
